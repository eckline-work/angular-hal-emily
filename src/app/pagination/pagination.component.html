<div class="d-flex flex-wrap justify-content-center">

  <ng-container class="d-flex flex-wrap justify-content-center" *ngIf="collectionSize > 0">
    <p>
      Total Rows:&nbsp;<b>{{collectionSize}}</b><br>
    </p>

    <table class="table table-hover">
      <thead>
        <tr class="table-primary">
          <th scope="col" style="width: 10%;">System</th>
          <th scope="col" style="width: 20%;">Number/Message</th>
          <th scope="col" style="width: 20%;">Process</th>
          <th scope="col" style="width: 20%;">Trace</th>
          <th scope="col" style="width: 10%;">Environment</th>
          <th scope="col" style="width: 10%;">Created&nbsp;Date</th>
          <th scope="col">ID</th>
        </tr>
      </thead>
      <tbody infinite-scroll [infiniteScrollDistance]="scrollDistance" [infiniteScrollThrottle]="throttle" [scrollWindow]="false" (scrolled)="onScroll()">
        <tr *ngFor="let i of array" class="table-light" (click)="msgTog(i.ID)">
          <td style="width: 10%;">{{i.SourceSystem}}</td>
          <td style="width: 20%;" placement="auto" ngbPopover="{{i.Message}}" container="body" triggers="hover focus click" ><span *ngIf="i.LogNumber">({{i.LogNumber}}) </span><span *ngIf="!i.LogNumber">(0) </span>{{i.Message | slice:0:30}}<span *ngIf="i.Message.length > 30">...</span><span *ngIf="i.Message == ''">No message included</span></td>
          <td style="width: 20%;">{{i.ProcessName | slice:0:30}}<span *ngIf="i.ProcessName.length > 30">...</span><span *ngIf="i.ProcessName == ''"> N/A</span></td>
          <td style="width: 20%;">{{i.TraceInfo | slice:0:30}}<span *ngIf="i.TraceInfo.length > 30">...</span><span *ngIf="i.TraceInfo == ''"> N/A</span></td>
          <td style="text-align: right; width: 10%;">{{i.EnvironmentInfo | slice:0:30}}<span *ngIf="i.EnvironmentInfo.length > 30">...</span></td>
          <td style="text-align: center; width: 10%;">{{i.StartDate | date :'yyyy-MM-dd'}}</td>
          <td style="text-align: center; width: 5rem;" class="text-primary">{{i.ID}}</td>
        </tr>
      </tbody>
    </table>
  </ng-container>

  <ng-container *ngIf="idPicked != -7">
    <div class="card border-info mb-3" cdkDrag style="z-index: 7; position: fixed; top: 4rem; right: 1rem; max-width: 55rem; width: 50%; min-width: 20rem;">
      <div class="card-header">
        HAL Message Viewer
        <button type="button" class="close float-right" (click)="msgClose(idPicked)">&times;</button>
      </div>
      <div class="card-body">
        <table class="table table-hover">
          <thead>
            <tr class="table-info">
              <th colspan="2" style="text-align: center;">Data for item ID: {{found.ID}}</th>
            </tr>
          </thead>
          <tbody>
            <tr class="table-light small">
              <th scope="row">System:</th>
              <td>{{found.SourceSystem}}</td>
            </tr>
            <tr class="table-light small">
              <th scope="row">Number/Message:</th>
              <td><span *ngIf="found.LogNumber">({{found.LogNumber}}) </span>{{found.Message}}<span *ngIf="found.Message == ''">No message included</span></td>
            </tr>
            <tr class="table-light small">
              <th scope="row">Process:</th>
              <td>{{found.ProcessName}}<span *ngIf="found.ProcessName == ''"> N/A</span></td>
            </tr>
            <tr class="table-light small">
              <th scope="row">Trace:</th>
              <td>{{found.TraceInfo}}<span *ngIf="found.TraceInfo == ''"> N/A</span></td>
            </tr>
            <tr class="table-light small">
              <th scope="row">Environment&nbsp;Info:</th>
              <td>{{found.EnvironmentInfo}}</td>
            </tr>
            <tr class="table-light small">
              <th scope="row">Created:</th>
              <td>{{found.StartDate | date :'yyyy-MM-dd'}}</td>
            </tr>
            <tr class="table-light small">
              <th scope="row">Processed:</th>
              <td>{{found.EndDate | date :'yyyy-MM-dd'}}</td>
            </tr>
          </tbody>  
        </table>
        <ng-container *ngIf="found.eT.code">
          <table class="table table-hover" style="text-align: center;">
            <thead>
              <tr class="table-dark">
                <th scope="col">Action</th>
                <th scope="col">Email</th>
                <th scope="col">Pager No.</th>
              </tr>
            </thead>
            <tbody>
              <tr class="table-light small">
                <td>
                  {{found.eT.code}}<br>
                  {{found.eT.desc}}
                </td>
                <td>{{found.eT.email}}</td>
                <td>{{found.eT.pager}}</td>
              </tr>
            </tbody>
          </table>
        </ng-container>
      </div>
    </div>
  </ng-container>

  <ng-container *ngIf="idPicked2 != -7">
    <div class="card border-info mb-3" cdkDrag style="z-index: 7; position: fixed; top: 6.5rem; right: .5rem; max-width: 55rem; width: 50%; min-width: 20rem;">
      <div class="card-header">
        HAL Message Viewer
        <button type="button" class="close float-right" (click)="msgClose(idPicked2)">&times;</button>
      </div>
      <div class="card-body">
        <table class="table table-hover">
          <thead>
            <tr class="table-info">
              <th colspan="2" style="text-align: center;">Data for item ID: {{found2.ID}}</th>
            </tr>
          </thead>
          <tbody>
            <tr class="table-light small">
              <th scope="row">System:</th>
              <td>{{found2.SourceSystem}}</td>
            </tr>
            <tr class="table-light small">
              <th scope="row">Number/Message:</th>
              <td><span *ngIf="found2.LogNumber">({{found2.LogNumber}}) </span>{{found2.Message}}<span *ngIf="found2.Message == ''">No message included</span></td>
            </tr>
            <tr class="table-light small">
              <th scope="row">Process:</th>
              <td>{{found2.ProcessName}} <span *ngIf="found2.ProcessName == ''">N/A</span></td>
            </tr>
            <tr class="table-light small">
              <th scope="row">Trace:</th>
              <td>{{found2.TraceInfo}}<span *ngIf="found2.TraceInfo == ''">N/A</span></td>
            </tr>
            <tr class="table-light small">
              <th scope="row">Environment&nbsp;Info:</th>
              <td>{{found2.EnvironmentInfo}}</td>
            </tr>
            <tr class="table-light small">
              <th scope="row">Created:</th>
              <td>{{found2.StartDate | date :'yyyy-MM-dd'}}</td>
            </tr>
            <tr class="table-light small">
              <th scope="row">Processed:</th>
              <td>{{found2.EndDate | date :'yyyy-MM-dd'}}</td>
            </tr>
          </tbody>  
        </table>
        <ng-container *ngIf="found2.eT.code">
          <table class="table table-hover" style="text-align: center;">
            <thead>
              <tr class="table-dark">
                <th scope="col">Action</th>
                <th scope="col">Email</th>
                <th scope="col">Pager No.</th>
              </tr>
            </thead>
            <tbody>
              <tr class="table-light small">
                <td>
                  {{found2.eT.code}}<br>
                  {{found2.eT.desc}}
                </td>
                <td>{{found2.eT.email}}</td>
                <td>{{found2.eT.pager}}</td>
              </tr>
            </tbody>
          </table>
        </ng-container>
      </div>
    </div>
  </ng-container>

  <ng-container *ngIf="collectionSize == 0">
    <div class="container" style="width: 100%">
      <p style="text-align: center;">
        <br>
        <span class="lead text-info">There are no items that match the given criteria.</span><br>
        <span class="text-muted">Please make changes to your selections, then try again.</span>
      </p>
    </div>
  </ng-container>
</div>

<nav class="navbar navbar-expand-lg navbar-light bg-light" style="position:fixed; top: 3.5rem; left: 0; width: 100%; z-index: 3;">
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarColor03" aria-controls="navbarColor03" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  <div class="collapse navbar-collapse" id="navbarColor03">
    <form class="form-inline my-2 my-lg-0">
        <div class="container col-sm-2" style="margin-left: 0; margin-right: 0; padding-top: 15px;">
          <div class="form-group">
            <div class="input-group mb-3">
              <select class="form-control form-control-sm" id="ProcSelect" #PS>
                <option selected="selected">Contains</option>
                <option>Begins With</option>
                <option>Ends With</option>
              </select>
              <input type="text" class="form-control form-control-sm" placeholder="Process" id="ProcInput" #PI>
            </div>
          </div>
        </div>
        <div class="container col-sm-2" style="margin-left: 0; margin-right: 0; padding-top: 15px;">
          <div class="form-group">
            <div class="input-group mb-3">
              <select class="form-control form-control-sm" id="TraceSelect" #TS>
                <option selected="selected">Contains</option>
                <option>Begins With</option>
                <option>Ends With</option>
              </select>
              <input type="text" class="form-control form-control-sm" placeholder="Trace" id="TraceInput" #TI>
            </div>
          </div>
        </div>
        <div class="container col-sm-2" style="margin-left: 0; margin-right: 0; padding-top: 15px;">
          <div class="form-group">
            <div class="input-group mb-3">
              <select class="form-control input-group-prepend form-control-sm" id="EnvSelect" #ES>
                <option selected="selected">Contains</option>
                <option>Begins With</option>
                <option>Ends With</option>
              </select>
              <input type="text" class="form-control form-control-sm" placeholder="Environment" id="EnvInput" #EI>
            </div>
          </div>
        </div>
        <div class="container col-sm" style="margin-left: 0; margin-right: 0; padding-top: 15px;">
          <div class="form-group input-group mb-3">
            <select class="form-control form-control-sm" id="S-Select" #Sys>
      	    <option disabled selected="selected" value="">-Select System-</option>
            <option value="">All</option>
	          <option>Claims Management</option>
    	      <option>Contact Managment</option>
            <option>Mandatory Medicare Reporting</option>
	          <option>Patient Safety</option>
          	<option>Rate Load Database</option>
  	        <option>Rate Staging Database</option>
            <option>Tdc Agency Management Web API</option>
            <option>Agent Broker</option>
            <option>Framework Web API Service</option>
            <option>Application Log</option>
	          <option>Application Log Database</option>
	          <option>EDoc - Clean Files</option>
            <option>Accounts Payable -  Informatica</option>
            <option>DBA</option>
            <option>Data Warehouse</option>
            <option>DWS</option>
            <option>EDoc Data Provider Server</option>
            <option>EDoc Server</option>
            <option>Email Server</option>
            <option>End of Day Jobs</option>
            <option>Folder Splitter</option>
            <option>iManage Server</option>
            <option>LBM Printer Server</option>
            <option>Members Only</option>
            <option>Members Only Internal (CSU)</option>
            <option>Macro Processor Server</option>
            <option>Nova</option>
            <option>Nova Informatica</option>
            <option>Online  Application</option>
            <option>Pitney Bowes</option>
            <option>Print Server</option>
            <option>Producer Compensation</option>
            <option>Retention Billing</option>
            <option>Report API</option>
            <option>OPCO Conversion</option>
            <option>Security</option>
            <option>Security Server</option>
            <option>Star</option>
            <option>Vista</option>
            <option>Unicenter</option>
            <option>Report Server</option>
            <option>DW - Nova Load</option>
            <option>SQL - SERVER</option>
            <option>Unknown</option>
            <option>Agency Management</option>
            </select>
          </div>
        </div>
        <div class="container col-sm" style="margin-left: 0; margin-right: 0; padding-top: 15px;">
          <div class="form-group input-group mb-3">
            <select class="form-control form-control-sm" id="I-Select" #Inc>
	            <option disabled selected="selected" value="">-Include-</option>
              <option value="">All</option>
	            <option value="Y">Errors</option>
	            <option value="N">Informational</option>
            </select>
          </div>
        </div>
        <div class="container col-sm" style="margin-left: 0; margin-right: 0; padding-top: 15px;">
          <div class="form-group input-group mb-3">
            <input class="form-control form-control-sm" placeholder="From" name="d1" #c1="ngModel" [(ngModel)]="model1" ngbDatepicker #d1="ngbDatepicker">
            <div class="input-group-append">
              <button class="btn btn-sm btn-outline-secondary dropdown-toggle" (click)="d1.toggle()" type="button"></button>
            </div>
          </div>
        </div>
        <div class="container col-sm" style="margin-left: 0; margin-right: 0; padding-top: 15px;">
          <div class="form-group input-group mb-3">
            <input class="form-control form-control-sm" placeholder="To" name="d2" #c2="ngModel" [(ngModel)]="model2" ngbDatepicker #d2="ngbDatepicker">
            <div class="input-group-append">
              <button class="btn btn-sm btn-outline-secondary dropdown-toggle" (click)="d2.toggle()" type="button"></button>
            </div>
          </div>
        </div>
        <div class="container col-sm" style="margin-left: 0; margin-right: 0;">
          <button class="btn btn-outline-primary btn-sm" (click)="pageSet(PS.value, TS.value, ES.value, Sys.value, Inc.value, PI.value, TI.value, EI.value, c1.value, c2.value)">
            Set Search Criteria
          </button>
        </div>
    </form>
  </div>
</nav>